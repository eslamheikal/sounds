<!doctype html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>مشغل صوت من يوتيوب</title>
    <style>
        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
            background: #0b0b0c;
            color: #fff;
            padding: 24px;
        }

        .player {
            max-width: 560px;
            margin: 0 auto;
            background: #141518;
            border: 1px solid #24262b;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, .35);
        }

        .row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 12px 0;
        }

        button {
            border: 0;
            padding: 10px 14px;
            border-radius: 12px;
            cursor: pointer;
            background: #2a2e36;
            color: #fff;
        }

        button:hover {
            background: #343944;
        }

        input[type="range"] {
            width: 100%
        }

        .meta {
            display: flex;
            justify-content: space-between;
            font-variant-numeric: tabular-nums;
            opacity: .85;
        }

        #yt-holder {
            position: absolute;
            left: -99999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
    </style>
</head>

<body>

    <div class="player" role="region" aria-label="مشغل صوت يوتيوب">
        <div class="row">
            <button id="playPause" aria-label="تشغيل">▶️ تشغيل</button>
            <div class="meta"><span id="now">00:00</span><span id="dur">--:--</span></div>
        </div>
        <div class="row">
            <input id="seek" type="range" min="0" max="100" value="0" aria-label="التقدم في المقطع">
        </div>
        <div class="row">
            <label for="vol" style="white-space:nowrap">🔊 الصوت</label>
            <input id="vol" type="range" min="0" max="100" value="80" aria-label="مستوى الصوت">
            <button id="mute" aria-label="كتم">🔇 كتم</button>
        </div>
    </div>

    <div id="yt-holder"></div>


    <iframe width="560" height="315" src="https://www.youtube.com/embed/DZteznd47B4?si=0cJ8ivT___CJ34nu"
        title="YouTube video player" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

    <!-- سكربت الـ API الصحيح -->
    <script src="https://www.youtube.com/embed/DZteznd47B4?si=0cJ8ivT___CJ34nu"></script>
    <script>
        let player, duration = 0, uiReady = false, tick;
        const VIDEO_ID = '6jVHREdafT8';

        window.onYouTubeIframeAPIReady = function () {
            player = new YT.Player('yt-holder', {
                videoId: VIDEO_ID,
                playerVars: { controls: 0, rel: 0, modestbranding: 1, playsinline: 1, autoplay: 1, mute: 1 },
                events: { onReady: onReady, onStateChange: onStateChange }
            });
        };

        const $ = (sel) => document.querySelector(sel);
        const playBtn = $('#playPause');
        const seek = $('#seek');
        const vol = $('#vol');
        const muteBtn = $('#mute');
        const nowEl = $('#now');
        const durEl = $('#dur');

        function fmt(t) { if (!isFinite(t)) t = 0; const m = Math.floor(t / 60), s = Math.floor(t % 60); return String(m).padStart(2, '0') + ':' + String(s).padStart(2, '0'); }

        function onReady() {
            player.setVolume(parseInt(vol.value, 10));
            duration = player.getDuration();
            if (duration) durEl.textContent = fmt(duration);

            // ابدأ التشغيل بصوت مكتوم
            player.mute();
            player.playVideo();

            // تحديث الوقت
            tick = setInterval(() => {
                const t = player.getCurrentTime();
                if (isFinite(t) && duration) {
                    nowEl.textContent = fmt(t);
                    seek.value = Math.min(100, Math.max(0, (t / duration) * 100));
                }
            }, 300);

            bindUI();
        }

        function onStateChange(e) {
            if (e.data === YT.PlayerState.PLAYING) {
                playBtn.textContent = '⏸️ إيقاف مؤقت';
            } else {
                playBtn.textContent = '▶️ تشغيل';
            }
            if (e.data === YT.PlayerState.ENDED) {
                player.seekTo(0, true);
                seek.value = 0;
            }
        }

        function bindUI() {
            if (uiReady) return; uiReady = true;

            playBtn.addEventListener('click', () => {
                const state = player.getPlayerState();
                if (state === YT.PlayerState.PLAYING) player.pauseVideo();
                else {
                    if (player.isMuted()) player.unMute();
                    player.playVideo();
                }
            });

            seek.addEventListener('input', () => {
                if (!duration) return;
                player.seekTo((seek.value / 100) * duration, true);
            });

            vol.addEventListener('input', () => {
                const v = parseInt(vol.value, 10);
                player.setVolume(v);
                if (v === 0 && !player.isMuted()) player.mute();
                if (v > 0 && player.isMuted()) player.unMute();
            });

            muteBtn.addEventListener('click', () => {
                if (player.isMuted()) {
                    player.unMute();
                    muteBtn.textContent = '🔇 كتم';
                } else {
                    player.mute();
                    muteBtn.textContent = '🔊 إلغاء الكتم';
                }
            });
        }

    </script>
</body>

</html>